
<!DOCTYPE html>
<html lang="he" dir="rtl">

<h1>ההזמנה שלך:</h1>

<head>
    <meta charset="UTF-8">
    <title>סיפרייה</title>
	<style>
		table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 5px;
    	}
    	th, td {
        border: 1px solid #333;
        padding: 12px;
        text-align: right;
    	}
		h1, h2{
			text-align: center;
		}
		pre {
			font-size: 16px;
		}
		button {
			text-align: center;
			font-size: 20px;
		}
		li {
            font-size: 20px;
        }
	</style>    
</head>
<body>
	<form method="POST" action="{{ url_for('place_order') }}">
			<table>
				<tbody>
					<thead>
					<tr>
						<td>סוג</td><td>שם</td><td>מחיר ליחידה</td><td>כמות הזמנה</td><td>מחיר כולל</td>
					</tr>
					</thead>  
                    {% for i in range(book_types|length) %}
                     <tr>
                        <td>{{book_types[i]}}  </td>
						<td>{{book_names[i]}}  </td>
                        <td>{{book_prices[i]}} </td>
						<td>{{quantities[i]}}  </td>
                        <td>{{total_prices[i]}}</td>
                    </tr>
                    {% endfor %}
					{% for i in range(book_types|length) %}
						<input type="hidden" name="book_types[]"  value="{{ book_types[i] }}">
						<input type="hidden" name="book_names[]"  value="{{ book_names[i] }}">
						<input type="hidden" name="book_prices[]" value="{{ book_prices[i] }}">
						<input type="hidden" name="quantities[]"  value="{{ quantities[i] }}">
					{% endfor %}
				</tbody>
			</table>
            <table>
				<tbody>
					<tr>
						<td>תשלום סופי:</td><td>{{total}}</td>
					</tr>          
				</tbody>
			</table>
			<h1>ההזמנה מוכנה!</h1>
			<h1>לחץ אישור לבצע מכירה:</h1>
			<h2>
				(*יש לוודא שהתשלום עבר)
				<br>
				<input type="text" name="seller" id="seller_input" placeholder="שם ספרן" required>
			</h2>
		<div style="text-align: center;">
		<button type="submit" id="submitBtn" name="confirm_action" value="true">אשר מכירה וסיים</button>
		</div>
	</form>

	<script>//script for lock button to avoid several push
		// find first 'from' , 'submitBtn'
		const form = document.querySelector('form');
		const btn = document.getElementById('submitBtn');

		form.addEventListener('submit', function(e) {
			if (btn.disabled) {
				e.preventDefault();
				return false;
			}

			btn.disabled = true; // disable btn
			btn.innerText = "שולח נתונים... נא להמתין"; 

			const hiddenInput = document.createElement('input');
			hiddenInput.type = 'hidden';
			hiddenInput.name = 'confirm_action';
			hiddenInput.value = 'true';
			form.appendChild(hiddenInput);

			return true;
		});
	</script>
</body>


<ul>
    <li><a href="{{ url_for('home') }}">ביטול וחזרה לדף ראשי</a></li>
	<li><a href="{{ url_for('sell_page') }}">ביטול וחזרה להזמנת ספרים</a></li>
    <li><a href="{{ url_for('stock_view') }}">ביטול וצפייה במלאי הספרים</a></li>
</ul>

</html>
